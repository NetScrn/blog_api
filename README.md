# README
## Разработчик №1
1. Странная архитектура сервисных классов – почему-то валидация происходит в билдере и потом создается либо объект в одном варианте, либо в другом. По сути это 2 абсолютно разных объекта, которые зачем-то засунуты в один класс. Почему нельзя было просто создать объект и сделать чтобы он потом сам себя валидировал – загадка.
2. Расчет рейтинга сделан очень странно – почему-то сам расчет происходит в контроллере, а апдейт – в бекграунде (для чего – непонятно). При большом количестве параллельных запросов у нас не всегда будет самое актуальное значение среднего рейтинга в базе.
3. Сокращение ave вместо avg выносит мозг.
4. Для чего запилены метод Post.reset_all_ave_cache – непонятно. Также непонятно для чего запилен дефолтный режим работы Post.top_ave (который не юзает индекс).
5. Запрос на пересекающиеся айпишники будет неизбежно тормозить при большом количестве данных. Метод Post.ips_used_by_multiple_users к слову вообще падает с ошибкой, как и спеки на него)))
6. Нет задания по SQL.

1 - ✓

2 - ✓

3 - sorry

4 - removed

5 - todo

6 - todo


## Разработчик №2
1. Самописные валидации, хотя можно применить рельсовые
2. Неоптимально сделано обновление рейтинга, при большом количестве запросов, очередь заполнится, лучше сделать без джобы вообще.
3. спек на апдейт рейтинга не работает, то есть джоба должна сама инлайном выполняться, а не дергаться хелпером
4. зато есть спек на джобу, но он не проверяет, как она работает
5. спека на апишки вообще нет (есть но не работает)
6. запрос с подзапросом мог бы достать сразу все что надо TOP_AVE_POSTS_QUERY
7. запрос IPS_USED_BY_MULTIPLE_USERS_QUERY мог бы иметь в хевинге count(*)>1
8. Логику аггрегации данных по постам можно было бы поместить в сервис, а в модели оставить только то, что связано с постом

1 - 
> В коде желательно не использовать рельсовых антипаттернов типа колбеков и валидаций в моделях